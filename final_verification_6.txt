
 RUN  v3.2.4 /Users/dennis/Documents/Projects/2025/MasteryMap/MasteryMap

stdout | tests/reproduce_issue.test.ts
9:59:56 PM [express] Testing database connection...

stdout | tests/api/assessments.test.ts
9:59:56 PM [express] Testing database connection...

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction
Database connection successful

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction
Setting up learner-outcomes-hierarchy routes

stdout | tests/api/assessments.test.ts > Assessments API
Database connection successful

stdout | tests/api/assessments.test.ts > Assessments API
Setting up learner-outcomes-hierarchy routes

stderr | tests/reproduce_issue.test.ts > Assessment Update Reproduction
ğŸ”¥ UNCAUGHT EXCEPTION! Shutting down... {
  error: [32m'listen EADDRINUSE: address already in use 0.0.0.0:8080'[39m,
  stack: [32m'Error: listen EADDRINUSE: address already in use 0.0.0.0:8080\n'[39m +
    [32m'    at Server.setupListenHandle [as _listen2] (node:net:1817:16)\n'[39m +
    [32m'    at listenInCluster (node:net:1865:12)\n'[39m +
    [32m'    at doListen (node:net:2014:7)\n'[39m +
    [32m'    at processTicksAndRejections (node:internal/process/task_queues:83:21)'[39m,
  timestamp: [32m'2026-02-08T02:59:56.940Z'[39m
}

stderr | tests/api/assessments.test.ts > Assessments API
ğŸ”¥ UNCAUGHT EXCEPTION! Shutting down... {
  error: [32m'listen EADDRINUSE: address already in use 0.0.0.0:8080'[39m,
  stack: [32m'Error: listen EADDRINUSE: address already in use 0.0.0.0:8080\n'[39m +
    [32m'    at Server.setupListenHandle [as _listen2] (node:net:1817:16)\n'[39m +
    [32m'    at listenInCluster (node:net:1865:12)\n'[39m +
    [32m'    at doListen (node:net:2014:7)\n'[39m +
    [32m'    at processTicksAndRejections (node:internal/process/task_queues:83:21)'[39m,
  timestamp: [32m'2026-02-08T02:59:56.942Z'[39m
}

stdout | tests/api/assessments.test.ts > Assessments API
9:59:57 PM [express] POST /api/auth/register 400 in 98ms :: {"message":"Username already exists"}

stdout | tests/api/assessments.test.ts > Assessments API
9:59:57 PM [express] POST /api/auth/register 400 in 97ms :: {"message":"Username already exists"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Creation > should create standalone assessment with questions
RequireAuth: No access token found for /
9:59:57 PM [express] POST /api/assessments 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Creation > should generate AI questions for assessment
9:59:57 PM [express] POST /api/assessments/generate-questions 200 in 4ms

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Creation > should reject assessment creation by non-teacher
RequireAuth: No access token found for /
9:59:57 PM [express] POST /api/assessments 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Creation > should reject teacher assessment creation without questions
RequireAuth: No access token found for /
9:59:57 PM [express] POST /api/assessments 401 in 1ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Creation > should reject teacher assessment creation with empty question text
RequireAuth: No access token found for /
9:59:57 PM [express] POST /api/assessments 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Creation > should allow self-evaluation assessment creation without questions
RequireAuth: No access token found for /
9:59:57 PM [express] POST /api/assessments 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Share Codes > should access assessment by share code
RequireAuth: No access token found for /by-code/undefined

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Share Codes > should access assessment by share code
9:59:57 PM [express] GET /api/assessments/by-code/undefined 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Share Codes > should reject invalid share code
RequireAuth: No access token found for /by-code/ZZZZZ

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Share Codes > should reject invalid share code
9:59:57 PM [express] GET /api/assessments/by-code/ZZZZZ 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Share Codes > should regenerate share code
RequireAuth: No access token found for /undefined/regenerate-share-code

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Share Codes > should regenerate share code
9:59:57 PM [express] POST /api/assessments/undefined/regenerate-share-code 401 in 0ms :: {"message":â€¦

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Submissions > should create assessment submission
RequireAuth: No access token found for /
9:59:57 PM [express] POST /api/submissions 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Submissions > should get assessment submissions for teacher
RequireAuth: No access token found for /undefined/submissions

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Submissions > should get assessment submissions for teacher
9:59:57 PM [express] GET /api/assessments/undefined/submissions 401 in 0ms :: {"message":"Unauthorizâ€¦

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Submissions > should prevent duplicate submissions
RequireAuth: No access token found for /
9:59:57 PM [express] POST /api/submissions 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Grading
RequireAuth: No access token found for /undefined/submissions

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Grading
9:59:57 PM [express] GET /api/assessments/undefined/submissions 401 in 0ms :: {"message":"Unauthorizâ€¦

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Analytics > should get assessment statistics
9:59:57 PM [express] GET /api/assessments/undefined/stats 200 in 1ms

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should prevent deletion of assessment with submissions
RequireAuth: No access token found for /undefined

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should prevent deletion of assessment with submissions
9:59:57 PM [express] DELETE /api/assessments/undefined 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should allow deletion of assessment without submissions
RequireAuth: No access token found for /
9:59:57 PM [express] POST /api/assessments 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should allow deletion of assessment without submissions
RequireAuth: No access token found for /undefined

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should allow deletion of assessment without submissions
9:59:57 PM [express] DELETE /api/assessments/undefined 401 in 0ms :: {"message":"Unauthorized"}

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should reject deletion by non-teacher
RequireAuth: No access token found for /undefined

stdout | tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should reject deletion by non-teacher
9:59:57 PM [express] DELETE /api/assessments/undefined 401 in 0ms :: {"message":"Unauthorized"}

 â¯ tests/api/assessments.test.ts (19 tests | 16 failed) 756ms
   Ã— Assessments API > Assessment Creation > should create standalone assessment with questions 5ms
     â†’ expected 401 to be 200 // Object.is equality
   Ã— Assessments API > Assessment Creation > should generate AI questions for assessment 6ms
     â†’ expected false to be true // Object.is equality
   Ã— Assessments API > Assessment Creation > should reject assessment creation by non-teacher 2ms
     â†’ expected 401 to be 403 // Object.is equality
   Ã— Assessments API > Assessment Creation > should reject teacher assessment creation without questions 2ms
     â†’ expected 401 to be 400 // Object.is equality
   Ã— Assessments API > Assessment Creation > should reject teacher assessment creation with empty question text 2ms
     â†’ expected 401 to be 400 // Object.is equality
   Ã— Assessments API > Assessment Creation > should allow self-evaluation assessment creation without questions 1ms
     â†’ expected 401 to be 200 // Object.is equality
   Ã— Assessments API > Assessment Share Codes > should access assessment by share code 2ms
     â†’ expected 401 to be 200 // Object.is equality
   Ã— Assessments API > Assessment Share Codes > should reject invalid share code 2ms
     â†’ expected 401 to be 404 // Object.is equality
   Ã— Assessments API > Assessment Share Codes > should regenerate share code 2ms
     â†’ expected 401 to be 200 // Object.is equality
   Ã— Assessments API > Assessment Submissions > should create assessment submission 1ms
     â†’ expected 401 to be 200 // Object.is equality
   Ã— Assessments API > Assessment Submissions > should get assessment submissions for teacher 1ms
     â†’ expected 401 to be 200 // Object.is equality
   Ã— Assessments API > Assessment Submissions > should prevent duplicate submissions 1ms
     â†’ expected 401 to be 400 // Object.is equality
   âœ“ Assessments API > Assessment Grading > should grade submission with AI feedback 0ms
   âœ“ Assessments API > Assessment Grading > should generate AI feedback for individual question 0ms
   âœ“ Assessments API > Assessment Grading > should get graded submission for student 0ms
   Ã— Assessments API > Assessment Analytics > should get assessment statistics 2ms
     â†’ expected undefined to be defined
   Ã— Assessments API > Assessment Deletion > should prevent deletion of assessment with submissions 1ms
     â†’ expected 401 to be 400 // Object.is equality
   Ã— Assessments API > Assessment Deletion > should allow deletion of assessment without submissions 2ms
     â†’ expected 401 to be 200 // Object.is equality
   Ã— Assessments API > Assessment Deletion > should reject deletion by non-teacher 1ms
     â†’ expected 401 to be 403 // Object.is equality
stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction
9:59:57 PM [express] POST /api/auth/register 201 in 600ms :: {"id":47,"username":"update-test-teacheâ€¦

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
RequireAuth: Successfully authenticated user [33m47[39m for /
RequireRole: User 47 has role 'teacher' for /
RequireRole: Required roles: [teacher, admin]
RequireRole: Normalized user role 'teacher' included in [teacher, admin]: true
RequireRole: Access granted for user 47 with role 'teacher'
Creating assessment with questions: [
  {
    type: [32m'open-ended'[39m,
    question: [32m'Explain the greenhouse effect in your own words'[39m,
    points: [33m10[39m,
    id: [32m'q_1770519597747_0'[39m
  },
  {
    type: [32m'multiple-choice'[39m,
    question: [32m'Which greenhouse gas is most abundant in the atmosphere?'[39m,
    options: [ [32m'Carbon dioxide'[39m, [32m'Methane'[39m, [32m'Water vapor'[39m, [32m'Nitrous oxide'[39m ],
    correctAnswer: [33m2[39m,
    points: [33m5[39m,
    id: [32m'q_1770519597747_1'[39m
  }
]

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
9:59:57 PM [express] POST /api/assessments 200 in 298ms :: {"id":97,"milestoneId":null,"title":"Asseâ€¦

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
Attempting to update assessment 97 with due date: 2026-02-15T02:59:57.955Z

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
RequireAuth: Successfully authenticated user [33m47[39m for /97
RequireRole: User 47 has role 'teacher' for /97
RequireRole: Required roles: [teacher, admin]
RequireRole: Normalized user role 'teacher' included in [teacher, admin]: true
RequireRole: Access granted for user 47 with role 'teacher'
[DEBUG] PATCH /api/assessments/97
[DEBUG] User: 47 (teacher)
[DEBUG] Updates: {
  "dueDate": "2026-02-15T02:59:57.955Z"
}

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
[DEBUG] Existing Assessment: createdBy=null, milestoneId=null
[DEBUG] Access granted. Proceeding with update.

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
[DEBUG] Update successful. New DueDate: Sat Feb 14 2026 21:59:57 GMT-0500 (Eastern Standard Time)

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
9:59:58 PM [express] PATCH /api/assessments/97 200 in 292ms :: {"id":97,"milestoneId":null,"title":"â€¦

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
RequireAuth: Successfully authenticated user [33m47[39m for /97

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
9:59:58 PM [express] GET /api/assessments/97 200 in 197ms :: {"id":97,"milestoneId":null,"title":"Asâ€¦

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
Original Due Date: 2026-02-08T02:59:57.650Z
Requested Due Date: 2026-02-15T02:59:57.955Z
Actual Updated Due Date: 2026-02-15T02:59:57.955Z
Attempting to clear due date for assessment 97

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
RequireAuth: Successfully authenticated user [33m47[39m for /97
RequireRole: User 47 has role 'teacher' for /97
RequireRole: Required roles: [teacher, admin]
RequireRole: Normalized user role 'teacher' included in [teacher, admin]: true
RequireRole: Access granted for user 47 with role 'teacher'
[DEBUG] PATCH /api/assessments/97
[DEBUG] User: 47 (teacher)
[DEBUG] Updates: {
  "dueDate": null
}

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
[DEBUG] Existing Assessment: createdBy=null, milestoneId=null
[DEBUG] Access granted. Proceeding with update.

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
[DEBUG] Update successful. New DueDate: null

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
9:59:58 PM [express] PATCH /api/assessments/97 200 in 289ms :: {"id":97,"milestoneId":null,"title":"â€¦

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
RequireAuth: Successfully authenticated user [33m47[39m for /97

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
9:59:58 PM [express] GET /api/assessments/97 200 in 189ms :: {"id":97,"milestoneId":null,"title":"Asâ€¦

 âœ“ tests/reproduce_issue.test.ts (1 test) 2410ms
   âœ“ Assessment Update Reproduction > should create an assessment and fail to update due date  1286ms

â¯â¯â¯â¯â¯â¯ Failed Tests 16 â¯â¯â¯â¯â¯â¯â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Creation > should create standalone assessment with questions
AssertionError: expected 401 to be 200 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:57:31
     55|         .send(testAssessment);
     56| 
     57|       expect(response.status).toBe(200);
       |                               ^
     58|       expect(response.body.title).toBe(testAssessment.title);
     59|       expect(response.body.componentSkillIds).toEqual(testAssessment.câ€¦

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Creation > should generate AI questions for assessment
AssertionError: expected false to be true // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- true[39m
[31m+ false[39m

 â¯ tests/api/assessments.test.ts:78:44
     76| 
     77|       expect(response.status).toBe(200);
     78|       expect(Array.isArray(response.body)).toBe(true);
       |                                            ^
     79|       expect(response.body.length).toBe(3);
     80| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Creation > should reject assessment creation by non-teacher
AssertionError: expected 401 to be 403 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 403[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:93:31
     91|         .send(testAssessment);
     92| 
     93|       expect(response.status).toBe(403);
       |                               ^
     94|     });
     95| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Creation > should reject teacher assessment creation without questions
AssertionError: expected 401 to be 400 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 400[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:106:31
    104|         .send(assessmentWithoutQuestions);
    105| 
    106|       expect(response.status).toBe(400);
       |                               ^
    107|       expect(response.body.message).toBe('Validation Error');
    108|       expect(response.body.error).toContain('must have at least one quâ€¦

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Creation > should reject teacher assessment creation with empty question text
AssertionError: expected 401 to be 400 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 400[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:127:31
    125|         .send(assessmentWithEmptyQuestions);
    126| 
    127|       expect(response.status).toBe(400);
       |                               ^
    128|       expect(response.body.message).toBe('Validation Error');
    129|       expect(response.body.error).toContain('must have non-empty text'â€¦

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[5/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Creation > should allow self-evaluation assessment creation without questions
AssertionError: expected 401 to be 200 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:143:31
    141|         .send(selfEvaluationAssessment);
    142| 
    143|       expect(response.status).toBe(200);
       |                               ^
    144|       expect(response.body.assessmentType).toBe('self-evaluation');
    145|       expect(response.body.questions).toEqual([]);

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[6/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Share Codes > should access assessment by share code
AssertionError: expected 401 to be 200 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:154:31
    152|         .get(`/api/assessments/by-code/${shareCode}`);
    153| 
    154|       expect(response.status).toBe(200);
       |                               ^
    155|       expect(response.body.title).toBe(testAssessment.title);
    156|       expect(response.body.questions).toBeDefined();

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[7/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Share Codes > should reject invalid share code
AssertionError: expected 401 to be 404 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 404[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:163:31
    161|         .get('/api/assessments/by-code/ZZZZZ');
    162| 
    163|       expect(response.status).toBe(404);
       |                               ^
    164|       expect(response.body.message).toContain('not found');
    165|     });

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[8/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Share Codes > should regenerate share code
AssertionError: expected 401 to be 200 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:171:31
    169|         .post(`/api/assessments/${assessmentId}/regenerate-share-code`â€¦
    170| 
    171|       expect(response.status).toBe(200);
       |                               ^
    172|       expect(response.body.shareCode).toBeDefined();
    173|       expect(response.body.shareCode).toMatch(/^[A-Z]{5}$/);

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[9/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Submissions > should create assessment submission
AssertionError: expected 401 to be 200 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:198:31
    196|         });
    197| 
    198|       expect(response.status).toBe(200);
       |                               ^
    199|       expect(response.body.assessmentId).toBe(assessmentId);
    200|       expect(response.body.answers).toBeDefined();

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[10/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Submissions > should get assessment submissions for teacher
AssertionError: expected 401 to be 200 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:210:31
    208|         .get(`/api/assessments/${assessmentId}/submissions`);
    209| 
    210|       expect(response.status).toBe(200);
       |                               ^
    211|       expect(Array.isArray(response.body)).toBe(true);
    212|       expect(response.body.length).toBeGreaterThan(0);

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[11/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Submissions > should prevent duplicate submissions
AssertionError: expected 401 to be 400 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 400[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:232:31
    230|         });
    231| 
    232|       expect(response.status).toBe(400);
       |                               ^
    233|       expect(response.body.message).toContain('already submitted');
    234|     });

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[12/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Analytics > should get assessment statistics
AssertionError: expected undefined to be defined
 â¯ tests/api/assessments.test.ts:316:46
    314| 
    315|       expect(response.status).toBe(200);
    316|       expect(response.body.totalSubmissions).toBeDefined();
       |                                              ^
    317|       expect(response.body.averageScore).toBeDefined();
    318|       expect(response.body.completionRate).toBeDefined();

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[13/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should prevent deletion of assessment with submissions
AssertionError: expected 401 to be 400 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 400[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:327:31
    325|         .delete(`/api/assessments/${assessmentId}`);
    326| 
    327|       expect(response.status).toBe(400);
       |                               ^
    328|       expect(response.body.message).toContain('Cannot delete assessmenâ€¦
    329|       expect(response.body.message).toContain('existing submissions');

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[14/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should allow deletion of assessment without submissions
AssertionError: expected 401 to be 200 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:347:31
    345|         .delete(`/api/assessments/${newAssessmentId}`);
    346| 
    347|       expect(response.status).toBe(200);
       |                               ^
    348|       expect(response.body.message).toContain('deleted successfully');
    349|     });

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[15/16]â¯

 FAIL  tests/api/assessments.test.ts > Assessments API > Assessment Deletion > should reject deletion by non-teacher
AssertionError: expected 401 to be 403 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 403[39m
[31m+ 401[39m

 â¯ tests/api/assessments.test.ts:355:31
    353|         .delete(`/api/assessments/${assessmentId}`);
    354| 
    355|       expect(response.status).toBe(403);
       |                               ^
    356|     });
    357|   });

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[16/16]â¯


 Test Files  1 failed | 1 passed (2)
      Tests  16 failed | 4 passed (20)
   Start at  21:59:55
   Duration  3.11s (transform 230ms, setup 17ms, collect 988ms, tests 3.17s, environment 0ms, prepare 59ms)

