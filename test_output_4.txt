
 RUN  v3.2.4 /Users/dennis/Documents/Projects/2025/MasteryMap/MasteryMap

stdout | tests/reproduce_issue.test.ts
9:45:08 PM [express] Testing database connection...

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction
Database connection successful

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction
Setting up learner-outcomes-hierarchy routes

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction
9:45:09 PM [express] serving on port 8080

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction
9:45:09 PM [express] POST /api/auth/register 201 in 608ms :: {"id":43,"username":"update-test-teacheâ€¦

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
RequireAuth: Successfully authenticated user [33m43[39m for /
RequireRole: User 43 has role 'teacher' for /
RequireRole: Required roles: [teacher, admin]
RequireRole: Normalized user role 'teacher' included in [teacher, admin]: true
RequireRole: Access granted for user 43 with role 'teacher'
Creating assessment with questions: [
  {
    type: [32m'open-ended'[39m,
    question: [32m'Explain the greenhouse effect in your own words'[39m,
    points: [33m10[39m,
    id: [32m'q_1770518709767_0'[39m
  },
  {
    type: [32m'multiple-choice'[39m,
    question: [32m'Which greenhouse gas is most abundant in the atmosphere?'[39m,
    options: [ [32m'Carbon dioxide'[39m, [32m'Methane'[39m, [32m'Water vapor'[39m, [32m'Nitrous oxide'[39m ],
    correctAnswer: [33m2[39m,
    points: [33m5[39m,
    id: [32m'q_1770518709767_1'[39m
  }
]

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
9:45:09 PM [express] POST /api/assessments 200 in 311ms :: {"id":95,"milestoneId":null,"title":"Asseâ€¦

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
Attempting to update assessment 95 with due date: 2026-02-15T02:45:09.979Z

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
RequireAuth: Successfully authenticated user [33m43[39m for /95
RequireRole: User 43 has role 'teacher' for /95
RequireRole: Required roles: [teacher, admin]
RequireRole: Normalized user role 'teacher' included in [teacher, admin]: true
RequireRole: Access granted for user 43 with role 'teacher'
[DEBUG] PATCH /api/assessments/95
[DEBUG] User: 43 (teacher)
[DEBUG] Updates: {
  "dueDate": "2026-02-15T02:45:09.979Z"
}

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
[DEBUG] Existing Assessment: createdBy=null, milestoneId=null
[DEBUG] Access granted. Proceeding with update.

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
[DEBUG] Update successful. New DueDate: Sat Feb 14 2026 21:45:09 GMT-0500 (Eastern Standard Time)

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
9:45:10 PM [express] PATCH /api/assessments/95 200 in 293ms :: {"id":95,"milestoneId":null,"title":"â€¦

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
RequireAuth: Successfully authenticated user [33m43[39m for /95

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
9:45:10 PM [express] GET /api/assessments/95 200 in 195ms :: {"id":95,"milestoneId":null,"title":"Asâ€¦

stdout | tests/reproduce_issue.test.ts > Assessment Update Reproduction > should create an assessment and fail to update due date
Original Due Date: 2026-02-08T02:45:09.663Z
Requested Due Date: 2026-02-15T02:45:09.979Z
Actual Updated Due Date: 2026-02-15T02:45:09.979Z

 âœ“ tests/reproduce_issue.test.ts (1 test) 1851ms
   âœ“ Assessment Update Reproduction > should create an assessment and fail to update due date  814ms

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  21:45:07
   Duration  2.63s (transform 211ms, setup 10ms, collect 550ms, tests 1.85s, environment 0ms, prepare 32ms)

